<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>UVa OJ 1601 - The Morning after Halloween | Dash's Blog</title><meta name="author" content="Dash"><meta name="copyright" content="Dash"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ProblemYou are working for an amusement park as an operator of an obakeyashiki, or a haunted house, in which guests walk through narrow and dark corridors. The house is proud of their lively ghosts, w">
<meta property="og:type" content="article">
<meta property="og:title" content="UVa OJ 1601 - The Morning after Halloween">
<meta property="og:url" content="http://example.com/2016/08/04/learning/oj/--UVa%20OJ%201601%20-%20The%20Morning%20after%20Halloween--/index.html">
<meta property="og:site_name" content="Dash&#39;s Blog">
<meta property="og:description" content="ProblemYou are working for an amusement park as an operator of an obakeyashiki, or a haunted house, in which guests walk through narrow and dark corridors. The house is proud of their lively ghosts, w">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/avatar.jpg">
<meta property="article:published_time" content="2016-08-03T16:00:00.000Z">
<meta property="article:modified_time" content="2024-01-20T13:35:00.225Z">
<meta property="article:author" content="Dash">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="BFS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2016/08/04/learning/oj/--UVa%20OJ%201601%20-%20The%20Morning%20after%20Halloween--/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'UVa OJ 1601 - The Morning after Halloween',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-20 21:35:00'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">76</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Dash's Blog"><span class="site-name">Dash's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">UVa OJ 1601 - The Morning after Halloween</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2016-08-03T16:00:00.000Z" title="发表于 2016-08-04 00:00:00">2016-08-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-20T13:35:00.225Z" title="更新于 2024-01-20 21:35:00">2024-01-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">学习记录</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E7%BC%96%E7%A8%8B%E7%BB%83%E4%B9%A0/">编程练习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="UVa OJ 1601 - The Morning after Halloween"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a><strong>Problem</strong></h1><p>You are working for an amusement park as an operator of an obakeyashiki, or a haunted house, in which guests walk through narrow and dark corridors. The house is proud of their lively ghosts, which are actually robots remotely controlled by the operator, hiding here and there in the corridors. One morning, you found that the ghosts are not in the positions where they are supposed to be. Ah, yesterday was Halloween. Believe or not, paranormal spirits have moved them around the corridors in the night. You have to move them into their right positions before guests come. Your manager is eager to know how long it takes to restore the ghosts.</p>
<p>&emsp;&emsp;In this problem, you are asked to write a program that, given a floor map of a house, finds the smallest number of steps to move all ghosts to the positions where they are supposed to be.</p>
<p>&emsp;&emsp;A floor consists of a matrix of square cells. A cell is either a wall cell where ghosts cannot move into or a corridor cell where they can.</p>
<p>&emsp;&emsp;At each step, you can move any number of ghosts simultaneously. Every ghost can either stay in the current cell, or move to one of the corridor cells in its 4-neighborhood (i.e. immediately left, right, up or down), if the ghosts satisfy the following conditions:<br>&emsp;&emsp;1. No more than one ghost occupies one position at the end of the step.</p>
<p>&emsp;&emsp;2. No pair of ghosts exchange their positions one another in the step.<br><span id="more"></span></p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a><strong>Input</strong></h1><p>The input consists of at most 10 datasets, each of which represents a floor map of a house. w, h and n in the first line are integers, separated by a space. w and h are the floor width and height of the house, respectively. n is the number of ghosts. They satisfy the following constraints.</p>
<center>4 ≤ w ≤ 16, 4 ≤ h ≤ 16, 1 ≤ n ≤ 3</center>

<p>&emsp;&emsp;Subsequent h lines of w characters are the floor map. Each of cij is either:<br>&emsp;&emsp;• a ‘#’ representing a wall cell,<br>&emsp;&emsp;• a lowercase letter representing a corridor cell which is the initial position of a ghost,<br>&emsp;&emsp;• an uppercase letter representing a corridor cell which is the position where the ghost corresponding<br>to its lowercase letter is supposed to be, or<br>&emsp;&emsp;• a space representing a corridor cell that is none of the above.</p>
<p>&emsp;&emsp;In each map, each of the first n letters from a and the first n letters from A appears once and only once. Outermost cells of a map are walls; i.e. all characters of the first and last lines are sharps; and the first and last characters on each line are also sharps. All corridor cells in a map are connected; i.e. given a corridor cell, you can reach any other corridor cell by following corridor cells in the 4-neighborhoods. Similarly, all wall cells are connected. Any 2 × 2 area on any map has at least one sharp. You can assume that every map has a sequence of moves of ghosts that restores all ghosts to the positions where they are supposed to be.<br>&emsp;&emsp;The last dataset is followed by a line containing three zeros separated by a space.</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h1><p>For each dataset in the input, one line containing the smallest number of steps to restore ghosts intothe positions where they are supposed to be should be output. An output line should not contain extra characters such as spaces.</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a><strong>Sample Input</strong></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">5 5 2</span><br><span class="line">#####</span><br><span class="line">#A#B#</span><br><span class="line">#   #</span><br><span class="line">#b#a#</span><br><span class="line">#####</span><br><span class="line">16 4 3</span><br><span class="line">################</span><br><span class="line">## ########## ##</span><br><span class="line">#    ABCcba    #</span><br><span class="line">################</span><br><span class="line">16 16 3</span><br><span class="line">################</span><br><span class="line">### ##    #   ##</span><br><span class="line">##  #  ##   # c#</span><br><span class="line">#  ## ########b#</span><br><span class="line"># ##  # #   #  #</span><br><span class="line">#  # ##   # # ##</span><br><span class="line">##  a#  # # #  #</span><br><span class="line">### ## #### ## #</span><br><span class="line">##   #   #  #  #</span><br><span class="line">#  ##### # ## ##</span><br><span class="line">####   #B# #   #</span><br><span class="line">##  C#   #   ###</span><br><span class="line">#  # # ####### #</span><br><span class="line"># ######  A##  #</span><br><span class="line">#        #    ##</span><br><span class="line">################</span><br></pre></td></tr></table></figure>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a><strong>Sample Output</strong></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">7</span><br><span class="line">36</span><br><span class="line">77</span><br></pre></td></tr></table></figure>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a><strong>Solution</strong></h1><p>&emsp;&emsp;依旧是一道最短路径的题目。题目本身并不复杂，也没有太多的技巧性。和以往做过的最短路径题目的区别，无非是多了几个点，无形之中增加了程序的运行时间，但总体上的思路还是一样的。这里为了提高运行效率，利用了双向BFS。</p>
<p>&emsp;&emsp;题目给的时间上限是12s，这里所贴出的我的代码，运行时间是0.72s，还是比较可观的。在运用双向BFS的基础上，主要是利用了数组和建立空格图块的方法，来减少代码的运行时间。由于一开始看错题目，不想大改，所以代码显得略为冗长，但是便于理解。感兴趣的话，可以试着把代码段压缩一下，效率也会有所提升。</p>
<p>&emsp;&emsp;需要注意的地方是，用来存储队列的数组，尽量开大一些，避免还没找到重点，BFS就结束了。这道题我提交了三次，前两次都是queue_fro和queue_back开的太小，导致了WA。其余的无非就是注意一下在变量太多且名字相近的情况下，不要打错变量名字就行了。</p>
<p>&emsp;&emsp;P.S:最近在处理很多别的东西，昨晚又捣鼓了半天系统，更新可能会慢一点吧。<del>不过我知道，其实并没有什么人来看我博客啊！   T^T</del><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pos_now link[i][j]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pos_next link[i+next[0][k]][j+next[1][k]]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pos_a conn[queue_fro[fro_fro].a][i]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pos_b conn[queue_fro[fro_fro].b][j]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pos_c conn[queue_fro[fro_fro].c][k]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pos_A conn[queue_back[back_fro].a][i]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pos_B conn[queue_back[back_fro].b][j]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pos_C conn[queue_back[back_fro].c][k]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Node</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="type">int</span> a; <span class="type">int</span> b; <span class="type">int</span> c;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> next[<span class="number">2</span>][<span class="number">4</span>] = &#123; &#123; <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span> &#125;,</span><br><span class="line">                         &#123; <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span> &#125; &#125;;</span><br><span class="line"><span class="type">int</span> w, h, n, num;</span><br><span class="line"><span class="type">int</span> link[<span class="number">20</span>][<span class="number">20</span>], conn[<span class="number">305</span>][<span class="number">7</span>], vis[<span class="number">305</span>][<span class="number">305</span>][<span class="number">305</span>];</span><br><span class="line"><span class="type">int</span> beg[<span class="number">3</span>], end[<span class="number">3</span>];</span><br><span class="line"><span class="type">int</span> step_fro, step_back,</span><br><span class="line">	back_fro, back_rear,</span><br><span class="line">	 fro_fro,  fro_rear;</span><br><span class="line">Node queue_fro[<span class="number">4000000</span>], queue_back[<span class="number">4000000</span>];</span><br><span class="line"><span class="type">char</span> map[<span class="number">20</span>][<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> fro_cnt = <span class="number">1</span>, back_cnt = <span class="number">1</span>;</span><br><span class="line">    vis[beg[<span class="number">0</span>]][beg[<span class="number">1</span>]][beg[<span class="number">2</span>]] = ++step_fro;</span><br><span class="line">    vis[end[<span class="number">0</span>]][end[<span class="number">1</span>]][end[<span class="number">2</span>]] = ++step_back;</span><br><span class="line">    fro_fro  = back_fro  = <span class="number">0</span>;</span><br><span class="line">    fro_rear = back_rear = <span class="number">1</span>;</span><br><span class="line">    queue_fro[<span class="number">0</span>].a  = beg[<span class="number">0</span>],queue_fro[<span class="number">0</span>].b  = beg[<span class="number">1</span>],queue_fro[<span class="number">0</span>].c  = beg[<span class="number">2</span>];</span><br><span class="line">    queue_back[<span class="number">0</span>].a = end[<span class="number">0</span>],queue_back[<span class="number">0</span>].b = end[<span class="number">1</span>],queue_back[<span class="number">0</span>].c = end[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (fro_fro &lt; fro_rear)&#123;</span><br><span class="line">        ++step_fro;</span><br><span class="line">        <span class="keyword">while</span> (fro_cnt--)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; pos_a != <span class="number">0</span>; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; pos_b != <span class="number">0</span>; ++j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; pos_c != <span class="number">0</span>; ++k)&#123;</span><br><span class="line">                <span class="keyword">if</span> (beg[<span class="number">2</span>] != <span class="number">303</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (pos_a == queue_fro[fro_fro].b &amp;&amp; pos_b == queue_fro[fro_fro].a) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (pos_a == queue_fro[fro_fro].c &amp;&amp; pos_c == queue_fro[fro_fro].a) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (pos_b == queue_fro[fro_fro].c &amp;&amp; pos_c == queue_fro[fro_fro].b) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (pos_a == pos_b || pos_a == pos_c || pos_b == pos_c) <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (beg[<span class="number">1</span>] != <span class="number">303</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (pos_a == queue_fro[fro_fro].b &amp;&amp; pos_b == queue_fro[fro_fro].a) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (pos_a == pos_b) <span class="keyword">continue</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (vis[pos_a][pos_b][pos_c] &gt; <span class="number">1000</span>) <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">if</span> (vis[pos_a][pos_b][pos_c] &gt; <span class="number">0</span>)  <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">                vis[pos_a][pos_b][pos_c] = step_fro;</span><br><span class="line">                queue_fro[fro_rear].a = pos_a;</span><br><span class="line">                queue_fro[fro_rear].b = pos_b;</span><br><span class="line">                queue_fro[fro_rear].c = pos_c;</span><br><span class="line">                ++fro_rear;</span><br><span class="line">            &#125;</span><br><span class="line">            ++fro_fro;</span><br><span class="line">        &#125;</span><br><span class="line">        fro_cnt = fro_rear - fro_fro;</span><br><span class="line"></span><br><span class="line">        ++step_back;</span><br><span class="line">        <span class="keyword">while</span> (back_cnt--)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; pos_A != <span class="number">0</span>; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; pos_B != <span class="number">0</span>; ++j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; pos_C != <span class="number">0</span>; ++k)&#123;</span><br><span class="line">                <span class="keyword">if</span> (beg[<span class="number">2</span>] != <span class="number">303</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (pos_A == queue_back[back_fro].b &amp;&amp; pos_B == queue_back[back_fro].a) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (pos_A == queue_back[back_fro].c &amp;&amp; pos_C == queue_back[back_fro].a) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (pos_B == queue_back[back_fro].c &amp;&amp; pos_C == queue_back[back_fro].b) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (pos_A == pos_B || pos_A == pos_C || pos_B == pos_C) <span class="keyword">continue</span>;</span><br><span class="line">				&#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (beg[<span class="number">1</span>] != <span class="number">303</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (pos_A == queue_back[back_fro].b &amp;&amp; pos_B == queue_back[back_fro].a) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (pos_A == pos_B) <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (vis[pos_A][pos_B][pos_C] &gt; <span class="number">1000</span>) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (vis[pos_A][pos_B][pos_C] &gt; <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">                vis[pos_A][pos_B][pos_C] = step_back;</span><br><span class="line">                queue_back[back_rear].a = pos_A;</span><br><span class="line">                queue_back[back_rear].b = pos_B;</span><br><span class="line">                queue_back[back_rear].c = pos_C;</span><br><span class="line">                ++back_rear;</span><br><span class="line">            &#125;</span><br><span class="line">            ++back_fro;</span><br><span class="line">        &#125;</span><br><span class="line">        back_cnt = back_rear - back_fro;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;w, &amp;h, &amp;n)==<span class="number">3</span> &amp;&amp; n)&#123;</span><br><span class="line">        <span class="built_in">getchar</span>();</span><br><span class="line">        <span class="comment">//初始化</span></span><br><span class="line">        <span class="built_in">memset</span>(map,  <span class="number">0</span>, <span class="built_in">sizeof</span>(map));</span><br><span class="line">        <span class="built_in">memset</span>(vis,  <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">        <span class="built_in">memset</span>(link, <span class="number">0</span>, <span class="built_in">sizeof</span>(link));</span><br><span class="line">        <span class="built_in">memset</span>(conn, <span class="number">0</span>, <span class="built_in">sizeof</span>(conn));</span><br><span class="line">        num = step_fro = <span class="number">0</span>;</span><br><span class="line">        step_back = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//对图进行输入并处理，建立可移动区域的图</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; ++i)</span><br><span class="line">            <span class="built_in">gets</span>(map[i]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; w; ++j)</span><br><span class="line">            <span class="keyword">if</span> (map[i][j] != <span class="string">&#x27;#&#x27;</span>)  link[i][j] = ++num;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i =<span class="number">0</span>; i &lt; h;++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; w; ++j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (link[i][j])&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (pos_next)</span><br><span class="line">                        conn[pos_now][++conn[pos_now][<span class="number">0</span>]] = pos_next;</span><br><span class="line">				&#125;</span><br><span class="line">                conn[pos_now][<span class="number">0</span>] = pos_now;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        beg[<span class="number">0</span>] = beg[<span class="number">1</span>] = beg[<span class="number">2</span>] = end[<span class="number">0</span>] = end[<span class="number">1</span>] = end[<span class="number">2</span>] = <span class="number">303</span>;</span><br><span class="line">        conn[<span class="number">303</span>][<span class="number">0</span>] = <span class="number">303</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; w; ++j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">islower</span>(map[i][j]))</span><br><span class="line">                beg[map[i][j] - <span class="string">&#x27;a&#x27;</span>] = pos_now;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isupper</span>(map[i][j]))</span><br><span class="line">                end[map[i][j] - <span class="string">&#x27;A&#x27;</span>] = pos_now;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">bfs</span>();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, step_fro + step_back - <span class="number">1002</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Dash</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2016/08/04/learning/oj/--UVa%20OJ%201601%20-%20The%20Morning%20after%20Halloween--/">http://example.com/2016/08/04/learning/oj/--UVa%20OJ%201601%20-%20The%20Morning%20after%20Halloween--/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Dash's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C++</a><a class="post-meta__tags" href="/tags/BFS/">BFS</a></div><div class="post_share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2016/08/04/essay/%E6%97%A0%E6%89%80%E4%BA%8B%E4%BA%8B%E7%9A%84%E9%97%B2%E6%9A%87%E6%97%B6%E5%85%89/" title="无所事事的闲暇时光"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">无所事事的闲暇时光</div></div></a></div><div class="next-post pull-right"><a href="/2016/08/01/learning/oj/--UVa%20OJ%2010603%20-%20Fill--/" title="UVa OJ 10603 - Fill"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">UVa OJ 10603 - Fill</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2016/08/01/learning/oj/--UVa%20OJ%2010603%20-%20Fill--/" title="UVa OJ 10603 - Fill"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-08-01</div><div class="title">UVa OJ 10603 - Fill</div></div></a></div><div><a href="/2020/02/19/development/image-to-asciiart/" title="Convert Image to ASCII Art"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-02-19</div><div class="title">Convert Image to ASCII Art</div></div></a></div><div><a href="/2016/09/22/learning/oj/--UVa%20OJ%201025%20-%20A%20Spy%20in%20the%20Metro--/" title="UVa OJ 714 - Copying Books"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-09-22</div><div class="title">UVa OJ 714 - Copying Books</div></div></a></div><div><a href="/2016/09/27/learning/oj/--UVa%20OJ%2010003%20-%20Cutting%20Sticks--/" title="UVa OJ 10003 - Cutting Sticks"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-09-27</div><div class="title">UVa OJ 10003 - Cutting Sticks</div></div></a></div><div><a href="/2016/08/14/learning/oj/--UVa%20OJ%2011054%20-%20Wine%20trading%20in%20Gergovia--/" title="UVa OJ 11054 - Wine trading in Gergovia"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-08-14</div><div class="title">UVa OJ 11054 - Wine trading in Gergovia</div></div></a></div><div><a href="/2016/09/03/learning/oj/--UVa%20OJ%2010954%20-%20Add%20All--/" title="UVa OJ 10954 - Add All"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-09-03</div><div class="title">UVa OJ 10954 - Add All</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Dash</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">76</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yuukidach"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">你好，我是 Dash，欢迎来到我的博客，希望你能在这里找到你想要的东西。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Problem"><span class="toc-number">1.</span> <span class="toc-text">Problem</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Input"><span class="toc-number">2.</span> <span class="toc-text">Input</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Output"><span class="toc-number">3.</span> <span class="toc-text">Output</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Sample-Input"><span class="toc-number">4.</span> <span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Sample-Output"><span class="toc-number">5.</span> <span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Solution"><span class="toc-number">6.</span> <span class="toc-text">Solution</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/10/10/config/easyconnect/" title="安全地使用Easy Connect">安全地使用Easy Connect</a><time datetime="2021-10-09T21:09:17.000Z" title="发表于 2021-10-10 05:09:17">2021-10-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/10/10/linux/unmute_problem/" title="Cannot Unmute With Keyboard">Cannot Unmute With Keyboard</a><time datetime="2021-10-09T20:40:37.000Z" title="发表于 2021-10-10 04:40:37">2021-10-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/01/20/learning/algorithm/mst/" title="最小生成树算法">最小生成树算法</a><time datetime="2021-01-20T00:08:26.000Z" title="发表于 2021-01-20 08:08:26">2021-01-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/01/07/learning/algorithm/floyd/" title="Floyd-Warshall 算法">Floyd-Warshall 算法</a><time datetime="2021-01-07T04:44:45.000Z" title="发表于 2021-01-07 12:44:45">2021-01-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/30/essay/migrate_to_hugo/" title="从HEXO迁移到HUGO"><img src="/2020/12/30/essay/migrate_to_hugo/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="从HEXO迁移到HUGO"/></a><div class="content"><a class="title" href="/2020/12/30/essay/migrate_to_hugo/" title="从HEXO迁移到HUGO">从HEXO迁移到HUGO</a><time datetime="2020-12-30T01:32:31.000Z" title="发表于 2020-12-30 09:32:31">2020-12-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2016 - 2024 By Dash</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>